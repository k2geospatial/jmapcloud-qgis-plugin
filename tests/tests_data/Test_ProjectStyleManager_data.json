{
    "common": {
        "layer_data": [
            [
                {
                    "createdBy": "08df0bbe@apikey.jmapcloud.io",
                    "creationDate": "2024-07-22T18:26:57Z",
                    "lastModifiedBy": "Jean-Robert Desbiens-Haddad <jrhaddad@k2geospatial.com>",
                    "lastModificationDate": "2025-02-28T16:34:19Z",
                    "id": "261d6aa8-2d6d-4ecd-b470-937b7e51e7cf",
                    "organizationId": "86f3606b-1224-4b2c-9ba1-eea5da829d1e",
                    "projectId": "82ffcfff-aacf-441a-aa0e-a794e24bedd2",
                    "spatialDataSourceId": "10269eaf-361a-495a-974f-1fc3cab4e85d",
                    "type": "VECTOR",
                    "elementType": "POINT",
                    "visible": true,
                    "listed": true,
                    "maximumZoom": 23.0,
                    "minimumZoom": 0.0,
                    "permissions": [
                        "EXTRACT_FEATURE"
                    ],
                    "tags": [],
                    "name": {
                        "fr": "Lieux",
                        "en": "Places"
                    },
                    "description": {
                        "en": "ire wojf wioejf ofoiejfoivej oejoij eijf oeijf eoij foeij oeji oj eorj eoigje goeijgoeijrg ef"
                    },
                    "attributes": [
                        {
                            "id": "7378694c-997d-4b37-b8d6-d9f7552117af",
                            "name": "nom_du_lie",
                            "type": "VARCHAR",
                            "indexed": false,
                            "title": {}
                        },
                        {
                            "id": "8041342d-6520-42ea-aaf6-b7946e6b5213",
                            "name": "nom_lie_en",
                            "type": "VARCHAR",
                            "indexed": false,
                            "title": {}
                        }
                    ],
                    "selectable": false,
                    "includeInMvt": true,
                    "selectionStyleId": "5420a6c8-d169-4a0a-98f3-4948f15cc6cd",
                    "mouseOverConfiguration": {
                        "active": false,
                        "preventDuplication": true,
                        "backgroundColor": "#ffffff",
                        "maximumZoom": 23.0,
                        "minimumZoom": 0.0,
                        "text": {
                            "fr": "<b>EV(nom_du_lie)</b>\nEV(adresse). EV(ville)\nEV(province), EV(code_posta)\n<a href=\"EV(site_inter)\">Site web</a>",
                            "en": "<b>EV(nom_lie_en)</b>\nEV(adresse). EV(ville)\nEV(province), EV(code_posta)\n<a href=\"EV(site_inter)\">Website</a>"
                        }
                    },
                    "labellingConfiguration": {
                        "active": true,
                        "maximumZoom": 23.0,
                        "minimumZoom": 16.570892,
                        "anchor": "TOP",
                        "offset": "POINT (0 0)",
                        "allowOverlapping": false,
                        "transparency": 0.0,
                        "outlined": false,
                        "outlineColor": "#ffffff",
                        "textSize": 11,
                        "textColor": "#000000",
                        "textBold": false,
                        "textItalic": false,
                        "followMapRotation": false,
                        "labelSpacing": 250,
                        "frameActive": false,
                        "frameFillColor": "#ffffff",
                        "frameTransparency": 0.0,
                        "frameBorderColor": "#000000",
                        "backgroundSymbolActive": false,
                        "backgroundSymbolOffset": "POINT (0 0)",
                        "text": {
                            "fr": "EV(nom_du_lie)",
                            "en": "EV(nom_lie_en)"
                        }
                    },
                    "searchForms": []
                },
                {
                    "createdBy": "Jean-Robert Desbiens-Haddad <jrhaddad@k2geospatial.com>",
                    "creationDate": "2025-01-22T19:21:59Z",
                    "lastModifiedBy": "msavard <msavard@k2geospatial.com>",
                    "lastModificationDate": "2025-02-27T21:43:43Z",
                    "id": "eb18e8e5-9af7-48fe-9be0-5043bf186517",
                    "organizationId": "86f3606b-1224-4b2c-9ba1-eea5da829d1e",
                    "projectId": "82ffcfff-aacf-441a-aa0e-a794e24bedd2",
                    "spatialDataSourceId": "e9cb7700-98d2-4114-a62d-f740026ec444",
                    "type": "VECTOR",
                    "elementType": "POLYGON",
                    "visible": true,
                    "listed": true,
                    "maximumZoom": 23.0,
                    "minimumZoom": 0.0,
                    "permissions": [
                        "EXTRACT_FEATURE"
                    ],
                    "tags": [],
                    "name": {
                        "fr": "ilotschaleur_shp"
                    },
                    "description": {},
                    "attributes": [
                        {
                            "id": "4bc6884b-4452-4c86-a802-1a004cc3cfd0",
                            "name": "objectid",
                            "type": "INTEGER",
                            "indexed": false,
                            "title": {}
                        }
                    ],
                    "selectable": true,
                    "includeInMvt": true,
                    "selectionStyleId": "c198959e-5451-4422-bfcc-e99f958ccbd7",
                    "labellingConfiguration": {
                        "active": true,
                        "maximumZoom": 23.0,
                        "minimumZoom": 11.0,
                        "anchor": "CENTER",
                        "offset": "POINT (0 0)",
                        "allowOverlapping": true,
                        "transparency": 0.0,
                        "outlined": false,
                        "outlineColor": "#000000",
                        "textSize": 23,
                        "textColor": "#d9f32b",
                        "textBold": true,
                        "textItalic": false,
                        "followMapRotation": false,
                        "labelSpacing": 250,
                        "frameActive": true,
                        "frameFillColor": "#830657",
                        "frameTransparency": 0.0,
                        "frameBorderColor": "#000000",
                        "backgroundSymbolActive": false,
                        "backgroundSymbolOffset": "POINT (0 0)",
                        "text": {
                            "fr": "Yo!"
                        }
                    },
                    "searchForms": []
                }
            ]
        ],
        "labeling_data": [
            {
                "active": true,
                "maximumZoom": 23.0,
                "minimumZoom": 16.0,
                "anchor": "CENTER",
                "offset": "POINT (-13 0)",
                "allowOverlapping": false,
                "transparency": 0.0,
                "outlined": false,
                "outlineColor": "#000000",
                "textSize": 11,
                "textColor": "#000000",
                "textBold": false,
                "textItalic": false,
                "followMapRotation": false,
                "labelSpacing": 250,
                "frameActive": false,
                "frameFillColor": "#ffffff",
                "frameTransparency": 0.0,
                "frameBorderColor": "#000000",
                "backgroundSymbolActive": false,
                "text": "typ_voie nom_voie"
            },
            {
                "active": true,
                "maximumZoom": 23.0,
                "minimumZoom": 11.0,
                "anchor": "CENTER",
                "offset": "POINT (0 0)",
                "allowOverlapping": true,
                "transparency": 0.0,
                "outlined": false,
                "outlineColor": "#000000",
                "textSize": 23,
                "textColor": "#d9f32b",
                "textBold": true,
                "textItalic": false,
                "followMapRotation": false,
                "labelSpacing": 250,
                "frameActive": true,
                "frameFillColor": "#830657",
                "frameTransparency": 0.0,
                "frameBorderColor": "#000000",
                "backgroundSymbolActive": false,
                "backgroundSymbolOffset": "POINT (0 0)",
                "text": "'Yo!'"
            }
        ],
        "formatted_style": [
            {
                "0c9e976e-f782-49c2-86df-aad803f43c3e": {
                    "styleRules": {
                        "0fa31bd6-37a0-4143-a283-744bdde533d4": {
                            "74e1456b-f1a5-41a6-a584-e6f2d62b2630": {
                                "conditionExpressions": null,
                                "styleMapScales": {
                                    "4ed207d7-12e2-4acd-a974-896b98f0de82": {
                                        "styles": {
                                            "f6adac1e-a088-407e-8b2b-21f804a9a686": {
                                                "raster-opacity": 1.0,
                                                "visibility": "visible"
                                            }
                                        },
                                        "maximumZoom": 23.0,
                                        "minimumZoom": 0.0,
                                        "type": "raster"
                                    }
                                },
                                "name": "Default condition",
                                "styleRuleName": "Default rule"
                            }
                        }
                    },
                    "label": {}
                },
                "fed2504c-6a16-422d-a68d-ded57a9edd77": {
                    "styleRules": {
                        "1fa5a2c2-7b0b-401d-b044-46efa75a6087": {
                            "2a90e938-c164-47b5-ba4d-9a980d2d3ca9": {
                                "conditionExpressions": null,
                                "styleMapScales": {
                                    "edf8f072-ea90-4f47-8212-79d8aaa62d4d": {
                                        "styles": {
                                            "e3e9116c-1542-47e9-9ce0-61b127ec24fa": {
                                                "raster-opacity": 1.0,
                                                "visibility": "visible"
                                            }
                                        },
                                        "maximumZoom": 23.0,
                                        "minimumZoom": 0.0,
                                        "type": "raster"
                                    }
                                }
                            }
                        }
                    },
                    "label": {}
                },
                "38316b1e-08c8-443a-9528-05f7f86ca6e2": {
                    "styleRules": {
                        "7f60535e-8628-405b-8635-7273bd8ce99f": {
                            "cd08c797-3f1d-4d7f-939b-8cb17cead2ff": {
                                "conditionExpressions": null,
                                "styleMapScales": {
                                    "b307102f-753f-4d4d-8085-a6210860e5dc": {
                                        "styles": {
                                            "a94511d8-c277-4a69-8a77-0021462cc8a1": {
                                                "fill-color": "#afd1f7",
                                                "fill-opacity": 1.0,
                                                "visibility": "visible",
                                                "line-width": 2,
                                                "line-opacity": 1.0,
                                                "line-color": "#000913"
                                            }
                                        },
                                        "maximumZoom": 23.0,
                                        "minimumZoom": 9.0,
                                        "type": "fill"
                                    },
                                    "962794c8-d508-4f82-b30d-1dbc9800398a": {
                                        "styles": {
                                            "d3ae1022-803a-428a-a857-d01db0a36ded": {
                                                "fill-color": "#00ffd3",
                                                "fill-opacity": 1.0,
                                                "visibility": "visible",
                                                "line-width": 3,
                                                "line-opacity": 1.0,
                                                "line-color": "#000913"
                                            }
                                        },
                                        "maximumZoom": 9.0,
                                        "minimumZoom": 0.0,
                                        "type": "fill"
                                    }
                                },
                                "name": "Default condition",
                                "styleRuleName": "Default rule"
                            }
                        }
                    },
                    "label": {}
                },
                "a2ca13f9-853e-4f44-acee-708698f05d04": {
                    "styleRules": {
                        "5e9524ef-a4ae-44c0-bd9e-c139d7c15d5d": {
                            "0dcb0609-ad5d-4515-8211-f115dd4175f2": {
                                "conditionExpressions": null,
                                "styleMapScales": {
                                    "962794c8-d508-4f82-b30d-1dbc9800398": {
                                        "styles": {
                                            "b9ffd007-08cf-4751-ac70-2207dd2fd99c": {
                                                "fill-outline-color": "#000000",
                                                "fill-color": "#3d87cd",
                                                "fill-opacity": 1.0,
                                                "visibility": "none"
                                            }
                                        },
                                        "maximumZoom": 11.5,
                                        "minimumZoom": 4.0,
                                        "type": "fill"
                                    }
                                },
                                "name": "name",
                                "styleRuleName": "Symbole unique"
                            }
                        }
                    },
                    "label": {
                        "active": true,
                        "maximumZoom": 23.0,
                        "minimumZoom": 11.0,
                        "anchor": "CENTER",
                        "offset": "POINT (0 0)",
                        "allowOverlapping": false,
                        "transparency": 0.0,
                        "outlined": true,
                        "outlineColor": "#000000",
                        "textSize": 11,
                        "textColor": "#ff0000",
                        "textBold": false,
                        "textItalic": false,
                        "followMapRotation": false,
                        "labelSpacing": 250,
                        "frameActive": false,
                        "frameFillColor": "#ffffff",
                        "frameTransparency": 0.0,
                        "frameBorderColor": "#000000",
                        "backgroundSymbolActive": false,
                        "backgroundSymbolOffset": "POINT (0 0)",
                        "text": "nom_qr"
                    }
                }
            }
        ],
        "style_rule": [
            {
                "5e9524ef-a4ae-44c0-bd9e-c139d7c15d5d": {
                    "0dcb0609-ad5d-4515-8211-f115dd4175f2": {
                        "conditionExpressions": "attribute('nom_mun') is not null",
                        "styleMapScales": {
                            "962794c8-d508-4f82-b30d-1dbc9800398": {
                                "styles": {
                                    "b9ffd007-08cf-4751-ac70-2207dd2fd99c": {
                                        "fill-outline-color": "#000000",
                                        "fill-color": "#3d87cd",
                                        "fill-opacity": 1.0,
                                        "visibility": "none"
                                    }
                                },
                                "maximumZoom": 11.5,
                                "minimumZoom": 4.0,
                                "type": "fill"
                            }
                        },
                        "name": "name",
                        "styleRuleName": "Symbole unique"
                    }
                }
            },
            {
                "7f60535e-8628-405b-8635-7273bd8ce99f": {
                    "cd08c797-3f1d-4d7f-939b-8cb17cead2ff": {
                        "conditionExpressions": null,
                        "styleMapScales": {
                            "b307102f-753f-4d4d-8085-a6210860e5dc": {
                                "styles": {
                                    "a94511d8-c277-4a69-8a77-0021462cc8a1": {
                                        "fill-color": "#afd1f7",
                                        "fill-opacity": 1.0,
                                        "visibility": "visible",
                                        "line-width": 2,
                                        "line-opacity": 1.0,
                                        "line-color": "#000913"
                                    }
                                },
                                "maximumZoom": 23.0,
                                "minimumZoom": 9.0,
                                "type": "fill"
                            },
                            "962794c8-d508-4f82-b30d-1dbc9800398a": {
                                "styles": {
                                    "d3ae1022-803a-428a-a857-d01db0a36ded": {
                                        "fill-color": "#00ffd3",
                                        "fill-opacity": 1.0,
                                        "visibility": "visible",
                                        "line-width": 3,
                                        "line-opacity": 1.0,
                                        "line-color": "#000913"
                                    }
                                },
                                "maximumZoom": 9.0,
                                "minimumZoom": 0.0,
                                "type": "fill"
                            }
                        },
                        "name": "Default condition",
                        "styleRuleName": "Default rule"
                    }
                },
                "9b2f6f7e-54d5-4a2c-843b-11d8d7e5b7c5": {
                    "0c7b6b5a-1b2a-46c3-8a4a-5f5c2c7f55c5": {
                        "conditionExpressions": "attribute('nom_mun') is not null",
                        "styleMapScales": {
                            "2b5b5f5c-8f3e-4f44-8d93-8a3b5c5f3f3f": {
                                "styles": {
                                    "7b7f1f9e-9b9b-4c33-8a0c-8a1c2f3c3e3e": {
                                        "fill-outline-color": "#ff0000",
                                        "fill-color": "#ffff00",
                                        "fill-opacity": 0.8,
                                        "visibility": "visible"
                                    }
                                },
                                "maximumZoom": 12.0,
                                "minimumZoom": 5.0,
                                "type": "fill"
                            }
                        },
                        "name": "nom",
                        "styleRuleName": "Symbole"
                    }
                }
            }
        ],
        "style_map_scale": [
            {
                "styles": {
                    "a94511d8-c277-4a69-8a77-0021462cc8a1": {
                        "fill-color": "#afd1f7",
                        "fill-opacity": 1.0,
                        "visibility": "visible",
                        "line-width": 2,
                        "line-opacity": 1.0,
                        "line-color": "#000913"
                    }
                },
                "maximumZoom": 23.0,
                "minimumZoom": 9.0,
                "type": "fill"
            },
            {
                "styles": {
                    "bff8e339-2628-457d-af5a-7365ace5d4ea": {
                        "line-width": 6,
                        "line-opacity": 1.0,
                        "line-color": "#8a8a8a",
                        "visibility": "visible",
                        "line-miter-limit": 2.0,
                        "line-round-limit": 1.05,
                        "line-cap": "round",
                        "line-join": "miter"
                    },
                    "3f41763d-209c-4357-b544-df606f3b2ca4": {
                        "line-width": 2,
                        "line-opacity": 1.0,
                        "line-dasharray": [
                            1.0,
                            5.0
                        ],
                        "line-color": "#ff0000",
                        "visibility": "visible",
                        "line-miter-limit": 2.0,
                        "line-round-limit": 1.05,
                        "line-cap": "round",
                        "line-join": "miter"
                    }
                },
                "maximumZoom": 23.0,
                "minimumZoom": 0.0,
                "type": "line"
            },
            {
                "styles": {
                    "d98b730d-bebe-448a-a406-7bc5d89d8f07": {
                        "icon-translate": [
                            2.0,
                            2.0
                        ],
                        "icon-opacity": 1.0,
                        "icon-allow-overlap": true,
                        "visibility": "visible",
                        "text-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "icon-image": "d98b730d-bebe-448a-a406-7bc5d89d8f07"
                    },
                    "5f42c073-a25b-4a99-8579-1db845a4e00e": {
                        "icon-translate": [
                            0.0,
                            -0.0
                        ],
                        "icon-opacity": 1.0,
                        "icon-allow-overlap": true,
                        "visibility": "visible",
                        "text-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "icon-image": "5f42c073-a25b-4a99-8579-1db845a4e00e"
                    },
                    "f0390779-7d15-40c8-9f0d-57d97540dabe": {
                        "icon-translate": [
                            0.0,
                            -0.0
                        ],
                        "icon-opacity": 1.0,
                        "icon-allow-overlap": true,
                        "visibility": "visible",
                        "text-allow-overlap": true,
                        "icon-ignore-placement": true,
                        "icon-image": "f0390779-7d15-40c8-9f0d-57d97540dabe"
                    }
                },
                "maximumZoom": 23.0,
                "minimumZoom": 0.0,
                "type": "symbol"
            },
            {
                "styles": {
                    "d213a5b9-3b02-4870-8232-9e5e71ac18b4": {
                        "text-color": "#000000",
                        "text-opacity": 1.0,
                        "text-rotate": {
                            "__class__": "QGISExpression",
                            "value": "-(annotation_angle)"
                        },
                        "text-max-width": 1000,
                        "visibility": "visible",
                        "text-field": {
                            "__class__": "QGISExpression",
                            "value": "annotation_text"
                        },
                        "text-rotation-alignment": "map",
                        "text-anchor": "center",
                        "text-size": {
                            "__class__": "QGISExpression",
                            "value": "to_real(annotation_height_3857)/2^(23-  @vector_tile_zoom )"
                        },
                        "text-allow-overlap": true,
                        "symbol-placement": "point",
                        "text-font": [
                            "Open Sans Regular"
                        ]
                    }
                },
                "maximumZoom": 23.0,
                "minimumZoom": 0.0,
                "type": "symbol"
            }
        ]
    },
    "test_format_JMap_label_configs": {
        "data": [],
        "expected": [
            {
                "261d6aa8-2d6d-4ecd-b470-937b7e51e7cf": {
                    "active": true,
                    "maximumZoom": 23.0,
                    "minimumZoom": 16.570892,
                    "anchor": "TOP",
                    "offset": "POINT (0 0)",
                    "allowOverlapping": false,
                    "transparency": 0.0,
                    "outlined": false,
                    "outlineColor": "#ffffff",
                    "textSize": 11,
                    "textColor": "#000000",
                    "textBold": false,
                    "textItalic": false,
                    "followMapRotation": false,
                    "labelSpacing": 250,
                    "frameActive": false,
                    "frameFillColor": "#ffffff",
                    "frameTransparency": 0.0,
                    "frameBorderColor": "#000000",
                    "backgroundSymbolActive": false,
                    "backgroundSymbolOffset": "POINT (0 0)",
                    "text": "nom_du_lie"
                },
                "eb18e8e5-9af7-48fe-9be0-5043bf186517": {
                    "active": true,
                    "maximumZoom": 23.0,
                    "minimumZoom": 11.0,
                    "anchor": "CENTER",
                    "offset": "POINT (0 0)",
                    "allowOverlapping": true,
                    "transparency": 0.0,
                    "outlined": false,
                    "outlineColor": "#000000",
                    "textSize": 23,
                    "textColor": "#d9f32b",
                    "textBold": true,
                    "textItalic": false,
                    "followMapRotation": false,
                    "labelSpacing": 250,
                    "frameActive": true,
                    "frameFillColor": "#830657",
                    "frameTransparency": 0.0,
                    "frameBorderColor": "#000000",
                    "backgroundSymbolActive": false,
                    "backgroundSymbolOffset": "POINT (0 0)",
                    "text": "'Yo!'"
                }
            }
        ]
    },
    "test_convert_mapbox_font": {
        "data": [
            [
                "Open Sans Regular"
            ],
            [
                "Open Sans Bold"
            ],
            [
                "Open Sans Bold Italic"
            ]
        ],
        "expected": [
            [
                "Open Sans",
                "Regular"
            ],
            [
                "Open Sans",
                "Bold"
            ],
            [
                "Open Sans",
                "Bold Italic"
            ]
        ]
    },
    "test_get_project_icons_from_sprite_sheet": {
        "data": [],
        "expected": [
            {
                "01590362-0caf-4188-bb06-2d85c56917c5": {
                    "path": "./chemin/random.png",
                    "width": 30,
                    "height": 30,
                    "pixelRatio": 2
                },
                "073fbd19-c27c-4307-a8a8-b514a67833b8": {
                    "path": "./chemin/random.png",
                    "width": 30,
                    "height": 30,
                    "pixelRatio": 2
                }
            }
        ]
    },
    "test_format_styles": {
        "data": [
            {
                "mapboxStyle": {
                    "version": 8,
                    "metadata": {
                        "project-name": {
                            "fr": "DÃ©mo",
                            "en": "Demo"
                        },
                        "bounds": [
                            -73.89129638671875,
                            45.40351225590907,
                            -73.4267807006836,
                            45.6560479566012
                        ],
                        "description": {},
                        "organization-id": "86f3606b-1224-4b2c-9ba1-eea5da829d1e",
                        "project-id": "82ffcfff-aacf-441a-aa0e-a794e24bedd2"
                    },
                    "sources": {
                        "jmap-cloud-wms-terrain-d2a5f50d-deae-45dd-b2da-773bf97c66be": {
                            "tiles": [
                                "https://api1.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=d2a5f50d-deae-45dd-b2da-773bf97c66be&bbox={bbox-epsg-3857}&terrain=true",
                                "https://api2.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=d2a5f50d-deae-45dd-b2da-773bf97c66be&bbox={bbox-epsg-3857}&terrain=true",
                                "https://api3.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=d2a5f50d-deae-45dd-b2da-773bf97c66be&bbox={bbox-epsg-3857}&terrain=true",
                                "https://api4.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=d2a5f50d-deae-45dd-b2da-773bf97c66be&bbox={bbox-epsg-3857}&terrain=true"
                            ],
                            "tileSize": 512,
                            "bounds": [
                                -73.9966885,
                                45.3851618,
                                -73.4738549,
                                45.7075957
                            ],
                            "maxzoom": 23,
                            "type": "raster-dem"
                        },
                        "jmap-cloud-wms-7a31cb2f-6d7c-421f-b264-2368c77909cf": {
                            "tiles": [
                                "https://api1.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=7a31cb2f-6d7c-421f-b264-2368c77909cf&bbox={bbox-epsg-3857}",
                                "https://api2.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=7a31cb2f-6d7c-421f-b264-2368c77909cf&bbox={bbox-epsg-3857}",
                                "https://api3.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=7a31cb2f-6d7c-421f-b264-2368c77909cf&bbox={bbox-epsg-3857}",
                                "https://api4.qa.jmapcloud.io/api/mis/wms?organizationId=86f3606b-1224-4b2c-9ba1-eea5da829d1e&request=GetMap&version=1.3.0&CRS=EPSG:3857&width=512&height=512&format=image/png&transparent=true&layers=7a31cb2f-6d7c-421f-b264-2368c77909cf&bbox={bbox-epsg-3857}"
                            ],
                            "tileSize": 512,
                            "bounds": [
                                -73.7546184,
                                45.661618,
                                -73.7287902,
                                45.7786202
                            ],
                            "type": "raster"
                        }
                    },
                    "layers": [
                        {
                            "id": "background_82ffcfff-aacf-441a-aa0e-a794e24bedd2",
                            "type": "background",
                            "metadata": {},
                            "paint": {
                                "background-color": "#ffffff"
                            },
                            "layout": {
                                "visibility": "visible"
                            }
                        },
                        {
                            "id": "l0-sr0-c0-ms0",
                            "type": "raster",
                            "source": "jmap-cloud-wms-7a31cb2f-6d7c-421f-b264-2368c77909cf",
                            "metadata": {
                                "style-rule-id": "0fa31bd6-37a0-4143-a283-744bdde533d4",
                                "style-id": "f6adac1e-a088-407e-8b2b-21f804a9a686",
                                "rule-condition-id": "74e1456b-f1a5-41a6-a584-e6f2d62b2630",
                                "style-map-scale-id": "4ed207d7-12e2-4acd-a974-896b98f0de82",
                                "layer-id": "0c9e976e-f782-49c2-86df-aad803f43c3e"
                            },
                            "paint": {
                                "raster-opacity": 1.0
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 0.0,
                            "maxzoom": 23.0
                        },
                        {
                            "id": "l1-sr0-c0-ms0",
                            "type": "raster",
                            "source": "wms-fed2504c-6a16-422d-a68d-ded57a9edd77",
                            "metadata": {
                                "style-rule-id": "1fa5a2c2-7b0b-401d-b044-46efa75a6087",
                                "style-id": "e3e9116c-1542-47e9-9ce0-61b127ec24fa",
                                "rule-condition-id": "2a90e938-c164-47b5-ba4d-9a980d2d3ca9",
                                "style-map-scale-id": "edf8f072-ea90-4f47-8212-79d8aaa62d4d",
                                "layer-id": "fed2504c-6a16-422d-a68d-ded57a9edd77"
                            },
                            "paint": {
                                "raster-opacity": 1.0
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 0.0,
                            "maxzoom": 23.0
                        },
                        {
                            "id": "l2-sr0-c0-ms0",
                            "type": "fill",
                            "source": "jmap-cloud-mvt",
                            "metadata": {
                                "style-rule-id": "7f60535e-8628-405b-8635-7273bd8ce99f",
                                "style-id": "a94511d8-c277-4a69-8a77-0021462cc8a1",
                                "rule-condition-id": "cd08c797-3f1d-4d7f-939b-8cb17cead2ff",
                                "style-map-scale-id": "b307102f-753f-4d4d-8085-a6210860e5dc",
                                "layer-id": "38316b1e-08c8-443a-9528-05f7f86ca6e2"
                            },
                            "paint": {
                                "fill-color": "#afd1f7",
                                "fill-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    0.0,
                                    1.0
                                ]
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 9.0,
                            "maxzoom": 23.0,
                            "source-layer": "86f3606b_ec6da92a_38316b1e"
                        },
                        {
                            "id": "l2-sr0-c0-ms0-border",
                            "type": "line",
                            "source": "jmap-cloud-mvt",
                            "metadata": {
                                "style-rule-id": "7f60535e-8628-405b-8635-7273bd8ce99f",
                                "style-id": "a94511d8-c277-4a69-8a77-0021462cc8a1",
                                "rule-condition-id": "cd08c797-3f1d-4d7f-939b-8cb17cead2ff",
                                "style-map-scale-id": "b307102f-753f-4d4d-8085-a6210860e5dc",
                                "layer-id": "38316b1e-08c8-443a-9528-05f7f86ca6e2"
                            },
                            "paint": {
                                "line-width": 2,
                                "line-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    0.0,
                                    1.0
                                ],
                                "line-color": "#000913"
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 9.0,
                            "maxzoom": 23.0,
                            "source-layer": "86f3606b_ec6da92a_38316b1e"
                        },
                        {
                            "id": "l2-sr0-c0-ms1",
                            "type": "fill",
                            "source": "jmap-cloud-mvt",
                            "metadata": {
                                "style-rule-id": "7f60535e-8628-405b-8635-7273bd8ce99f",
                                "style-id": "d3ae1022-803a-428a-a857-d01db0a36ded",
                                "rule-condition-id": "cd08c797-3f1d-4d7f-939b-8cb17cead2ff",
                                "style-map-scale-id": "962794c8-d508-4f82-b30d-1dbc9800398a",
                                "layer-id": "38316b1e-08c8-443a-9528-05f7f86ca6e2"
                            },
                            "paint": {
                                "fill-color": "#00ffd3",
                                "fill-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    0.0,
                                    1.0
                                ]
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 0.0,
                            "maxzoom": 9.0,
                            "source-layer": "86f3606b_ec6da92a_38316b1e"
                        },
                        {
                            "id": "l2-sr0-c0-ms1-border",
                            "type": "line",
                            "source": "jmap-cloud-mvt",
                            "metadata": {
                                "style-rule-id": "7f60535e-8628-405b-8635-7273bd8ce99f",
                                "style-id": "d3ae1022-803a-428a-a857-d01db0a36ded",
                                "rule-condition-id": "cd08c797-3f1d-4d7f-939b-8cb17cead2ff",
                                "style-map-scale-id": "962794c8-d508-4f82-b30d-1dbc9800398a",
                                "layer-id": "38316b1e-08c8-443a-9528-05f7f86ca6e2"
                            },
                            "paint": {
                                "line-width": 3,
                                "line-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    0.0,
                                    1.0
                                ],
                                "line-color": "#000913"
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 0.0,
                            "maxzoom": 9.0,
                            "source-layer": "86f3606b_ec6da92a_38316b1e"
                        },
                        {
                            "id": "l2-selection",
                            "type": "fill",
                            "source": "jmap-cloud-mvt",
                            "metadata": {
                                "style-id": "f587d909-434f-4478-bd9e-a20e049623aa",
                                "layer-id": "38316b1e-08c8-443a-9528-05f7f86ca6e2"
                            },
                            "paint": {
                                "fill-outline-color": "#000000",
                                "fill-color": "#ffff00",
                                "fill-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    1.0,
                                    0.0
                                ]
                            },
                            "layout": {
                                "visibility": "visible"
                            },
                            "minzoom": 0.0,
                            "maxzoom": 23.0,
                            "source-layer": "86f3606b_ec6da92a_38316b1e"
                        },
                        {
                            "id": "l3-sr0-c0-ms0",
                            "type": "fill",
                            "source": "jmap-cloud-geojson-44973732-c92f-43e4-8312-d057bf93eef4",
                            "metadata": {
                                "style-rule-id": "5e9524ef-a4ae-44c0-bd9e-c139d7c15d5d",
                                "style-id": "b9ffd007-08cf-4751-ac70-2207dd2fd99c",
                                "rule-condition-id": "0dcb0609-ad5d-4515-8211-f115dd4175f2",
                                "style-map-scale-id": "962794c8-d508-4f82-b30d-1dbc9800398",
                                "layer-id": "a2ca13f9-853e-4f44-acee-708698f05d04"
                            },
                            "paint": {
                                "fill-outline-color": "#000000",
                                "fill-color": "#3d87cd",
                                "fill-opacity": [
                                    "case",
                                    [
                                        "==",
                                        [
                                            "feature-state",
                                            "select-jmap"
                                        ],
                                        true
                                    ],
                                    0.0,
                                    1.0
                                ]
                            },
                            "layout": {
                                "visibility": "none"
                            },
                            "minzoom": 4.0,
                            "maxzoom": 11.5
                        }
                    ],
                    "bearing": 0.0,
                    "glyphs": "mapbox://fonts/mapbox/{fontstack}/{range}.pbf",
                    "sprite": "https://api.qa.jmapcloud.io/api/mcs/rest/v1/organizations/86f3606b-1224-4b2c-9ba1-eea5da829d1e/projects/82ffcfff-aacf-441a-aa0e-a794e24bedd2/mapbox-sprite",
                    "terrain": {
                        "source": "jmap-cloud-wms-terrain-d2a5f50d-deae-45dd-b2da-773bf97c66be",
                        "exaggeration": 1.0
                    }
                },
                "graphqlData": {
                    "data": {
                        "getStyleRules": [
                            {
                                "id": "7f60535e-8628-405b-8635-7273bd8ce99f",
                                "layerId": "38316b1e-08c8-443a-9528-05f7f86ca6e2",
                                "name": "Default rule",
                                "conditions": [
                                    {
                                        "id": "cd08c797-3f1d-4d7f-939b-8cb17cead2ff",
                                        "name": "Default condition"
                                    }
                                ]
                            },
                            {
                                "id": "0fa31bd6-37a0-4143-a283-744bdde533d4",
                                "layerId": "0c9e976e-f782-49c2-86df-aad803f43c3e",
                                "name": "Default rule",
                                "conditions": [
                                    {
                                        "id": "74e1456b-f1a5-41a6-a584-e6f2d62b2630",
                                        "name": "Default condition"
                                    }
                                ]
                            },
                            {
                                "id": "5e9524ef-a4ae-44c0-bd9e-c139d7c15d5d",
                                "layerId": "a2ca13f9-853e-4f44-acee-708698f05d04",
                                "name": "Symbole unique",
                                "conditions": [
                                    {
                                        "id": "0dcb0609-ad5d-4515-8211-f115dd4175f2",
                                        "name": "name"
                                    }
                                ]
                            }
                        ]
                    }
                },
                "labelingData": {
                    "a2ca13f9-853e-4f44-acee-708698f05d04": {
                        "active": true,
                        "maximumZoom": 23.0,
                        "minimumZoom": 11.0,
                        "anchor": "CENTER",
                        "offset": "POINT (0 0)",
                        "allowOverlapping": false,
                        "transparency": 0.0,
                        "outlined": true,
                        "outlineColor": "#000000",
                        "textSize": 11,
                        "textColor": "#ff0000",
                        "textBold": false,
                        "textItalic": false,
                        "followMapRotation": false,
                        "labelSpacing": 250,
                        "frameActive": false,
                        "frameFillColor": "#ffffff",
                        "frameTransparency": 0.0,
                        "frameBorderColor": "#000000",
                        "backgroundSymbolActive": false,
                        "backgroundSymbolOffset": "POINT (0 0)",
                        "text": "nom_qr"
                    }
                }
            }
        ],
        "expected": []
    },
    "test_get_layer_labels": {
        "data": [],
        "expected": [
            {
                "rule": {
                    "maximumScale": 35.0,
                    "minimumScale": 4513.0,
                    "active": true
                }
            },
            {
                "rule": {
                    "maximumScale": 35.0,
                    "minimumScale": 144447.0,
                    "active": true
                }
            }
        ]
    },
    "test_get_layer_styles": {
        "data": [],
        "expected": [
            {
                "styleRules": [
                    {
                        "label": "Symbole unique",
                        "rules": [
                            {
                                "label": "name",
                                "maximumScale": 102139.0,
                                "minimumScale": 18489297.0,
                                "active": true,
                                "filterExpression": "'attribute(\\'nom_mun\\') is not null'"
                            }
                        ]
                    }
                ]
            },
            {
                "styleRules": [
                    {
                        "label": "Default rule",
                        "rules": [
                            {
                                "label": "Default condition 9-23",
                                "maximumScale": 35.0,
                                "minimumScale": 577790.0,
                                "active": true,
                                "filterExpression": ""
                            },
                            {
                                "label": "Default condition 0-9",
                                "maximumScale": 577790.0,
                                "minimumScale": 295828763.0,
                                "active": true,
                                "filterExpression": ""
                            }
                        ]
                    },
                    {
                        "label": "Symbole",
                        "rules": [
                            {
                                "label": "nom",
                                "maximumScale": 72223.0,
                                "minimumScale": 9244648.0,
                                "active": true,
                                "filterExpression": "'attribute(\\'nom_mun\\') is not null'"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    "test_get_mvt_layer_labels": {
        "data": [
            {
                "elementType": "LINE"
            },
            {
                "elementType": "POLYGON"
            }
        ],
        "expected": [
            {
                "rule": {
                    "maximumZoom": 23.0,
                    "minimumZoom": 16.0,
                    "active": true
                },
                "elementType": "Line"
            },
            {
                "rule": {
                    "maximumZoom": 23.0,
                    "minimumZoom": 11.0,
                    "active": true
                },
                "elementType": "Polygon"
            }
        ]
    },
    "test_get_mvt_layer_styles": {
        "data": [
            {
                "elementType": "POLYGON"
            },
            {
                "elementType": "POLYGON"
            }
        ],
        "expected": [
            {
                "styleRules": [
                    {
                        "label": "Symbole unique",
                        "rules": [
                            {
                                "label": "name",
                                "maxZoomLevel": 11.0,
                                "minZoomLevel": 4.0,
                                "active": true,
                                "filterExpression": "'attribute(\\'nom_mun\\') is not null'"
                            }
                        ]
                    }
                ]
            },
            {
                "styleRules": [
                    {
                        "label": "Default rule",
                        "rules": [
                            {
                                "label": "Default condition 9-23",
                                "maxZoomLevel": 23.0,
                                "minZoomLevel": 9.0,
                                "active": true,
                                "filterExpression": ""
                            },
                            {
                                "label": "Default condition 0-9",
                                "maxZoomLevel": 9.0,
                                "minZoomLevel": 0.0,
                                "active": true,
                                "filterExpression": ""
                            }
                        ]
                    },
                    {
                        "label": "Symbole",
                        "rules": [
                            {
                                "label": "nom",
                                "maxZoomLevel": 12.0,
                                "minZoomLevel": 5.0,
                                "active": true,
                                "filterExpression": "'attribute(\\'nom_mun\\') is not null'"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    "test_convert_formatted_style_map_scale_to_symbol": {
        "data": [
            {
                "icons": {}
            },
            {
                "icons": {}
            },
            {
                "icons": {
                    "d98b730d-bebe-448a-a406-7bc5d89d8f07": {
                        "width": 60,
                        "height": 60,
                        "pixelRatio": 2,
                        "path": "./chemin/random/d98b730d-bebe-448a-a406-7bc5d89d8f07.png"
                    },
                    "5f42c073-a25b-4a99-8579-1db845a4e00e": {
                        "width": 30,
                        "height": 60,
                        "pixelRatio": 2,
                        "path": "./chemin/random/5f42c073-a25b-4a99-8579-1db845a4e00e.png"
                    },
                    "f0390779-7d15-40c8-9f0d-57d97540dabe": {
                        "width": 60,
                        "height": 30,
                        "pixelRatio": 5,
                        "path": "./chemin/random/f0390779-7d15-40c8-9f0d-57d97540dabe.png"
                    }
                }
            },
            {
                "icons": {}
            }
        ],
        "expected": [
            {
                "symbolLayers": [
                    {
                        "size": 30.0,
                        "fillColor": "#afd1f7",
                        "opacity": 1.0,
                        "lineWidth": 2,
                        "lineOpacity": 1.0,
                        "lineColor": "#000913",
                        "customProperties": {}
                    }
                ]
            },
            {
                "symbolLayers": [
                    {
                        "lineWidth": 6,
                        "lineOpacity": 1.0,
                        "lineColor": "#8a8a8a",
                        "visibility": "visible",
                        "lineMiterLimit": 2.0,
                        "lineRoundLimit": 1.05,
                        "lineCap": "round",
                        "lineJoin": "miter",
                        "customProperties": {}
                    },
                    {
                        "lineWidth": 2,
                        "lineOpacity": 1.0,
                        "lineDasharray": [
                            1.0,
                            5.0
                        ],
                        "lineColor": "#ff0000",
                        "visibility": "visible",
                        "lineMiterLimit": 2.0,
                        "lineRoundLimit": 1.05,
                        "lineCap": "round",
                        "lineJoin": "miter",
                        "customProperties": {}
                    }
                ]
            },
            {
                "symbolLayers": [
                    {
                        "iconImage": "d98b730d-bebe-448a-a406-7bc5d89d8f07",
                        "size": 30.0,
                        "fixedAspectRatio": 1.0,
                        "iconOpacity": 100,
                        "offsetX": 2,
                        "offsetY": 2,
                        "customProperties": {}
                    },
                    {
                        "icon-translate": [
                            0.0,
                            -0.0
                        ],
                        "size": 22.5,
                        "fixedAspectRatio": 0.5,
                        "iconOpacity": 100,
                        "offsetX": 0,
                        "offsetY": 0,
                        "iconImage": "5f42c073-a25b-4a99-8579-1db845a4e00e",
                        "customProperties": {}
                    },
                    {
                        "icon-translate": [
                            0.0,
                            -0.0
                        ],
                        "size": 9.0,
                        "fixedAspectRatio": 2.0,
                        "iconOpacity": 100,
                        "offsetX": 0,
                        "offsetY": 0,
                        "iconImage": "f0390779-7d15-40c8-9f0d-57d97540dabe",
                        "customProperties": {}
                    }
                ]
            },
            {
                "symbolLayers": [
                    {
                        "fontFamily": "Open Sans",
                        "fontStyle": "Regular",
                        "textColor": "#000000",
                        "textOpacity": 1.0,
                        "visibility": "visible",
                        "textRotationAlignment": "map",
                        "textAnchor": "center",
                        "symbolPlacement": "point",
                        "customProperties": {
                            "textField": "annotation_text",
                            "textRotate": "-(annotation_angle)",
                            "textSize": "to_real(annotation_height_3857)/2^(23-  @vector_tile_zoom )",
                            "textFont": "Open Sans Regular"
                        }
                    }
                ]
            }
        ]
    },
    "models": {
        "data": [],
        "expected": []
    }
}